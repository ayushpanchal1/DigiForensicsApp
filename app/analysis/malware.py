import yara
import pefile

def scan_file_for_yara(file_path, yara_rules_path='path_to_yara_rules.yar'):
    rules = yara.compile(filepath=yara_rules_path)
    matches = rules.match(file_path)
    if matches:
        return f'YARA matches found in {file_path}: {matches}'
    return 'No YARA matches found.'

def analyze_pe_file(file_path):
    pe = pefile.PE(file_path)
    pe_info = {'dlls': []}
    for entry in pe.DIRECTORY_ENTRY_IMPORT:
        pe_info['dlls'].append(entry.dll.decode())
    return pe_info
